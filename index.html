<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èªæ–‡ç§‘ï¼šé‡çµ„å¥å­éŠæˆ² (iPadç‰ˆ)</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mobile-drag-drop@2.3.0-rc.2/default.css">
    <script src="https://cdn.jsdelivr.net/npm/mobile-drag-drop@2.3.0-rc.2/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mobile-drag-drop@2.3.0-rc.2/scroll-behaviour.min.js"></script>

    <style>
        :root {
            --bg-color: #000000;
            --word-bg: #333333;
            --text-color: #ffffff;
            --accent-color: #ffff00; 
            --success-color: #00ff00;
            --error-color: #ff3333;
        }
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 10px;
            display: flex; flex-direction: column; align-items: center;
            /* é˜²æ­¢ iPad ä¸Šæ„å¤–çš„é é¢æ»‘å‹• */
            overflow-x: hidden;
            touch-action: pan-y;
        }
        
        .page { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        .img-container {
            width: 90%; max-width: 600px; height: 300px;
            margin: 10px 0; background-color: #111;
            border: 4px solid #444; display: flex;
            justify-content: center; align-items: center;
        }
        .top-img { width: 100%; height: 100%; object-fit: contain; }

        h1 { color: var(--accent-color); font-size: 2.5rem; margin: 10px 0; }
        
        .pool {
            display: flex; gap: 20px; margin: 20px 0;
            min-height: 140px; padding: 20px;
            border: 3px dashed #777; border-radius: 15px;
            width: 95%; justify-content: center; align-items: center; flex-wrap: wrap;
            background-color: #1a1a1a;
        }

        .word {
            background-color: var(--word-bg);
            border: 5px solid var(--text-color);
            padding: 20px 30px; border-radius: 15px;
            font-size: 3rem; 
            font-weight: bold; cursor: grab; color: white;
            /* é—œéµï¼šè®“ iPad çŸ¥é“é€™å€‹æ±è¥¿å¯ä»¥æ‘¸ */
            touch-action: none; 
            user-select: none;
            -webkit-user-select: none;
        }

        /* æ‹–æ‹‰æ™‚çš„æ¨£å¼ */
        .word.dnd-dragging { opacity: 0.5; transform: scale(1.1); border-color: var(--accent-color); }

        .feedback-area {
            font-size: 3.5rem; height: 80px; margin: 10px 0;
            font-weight: bold; text-align: center;
        }

        .drop-zone {
            width: 95%; height: 160px;
            border-bottom: 15px solid var(--accent-color);
            margin-bottom: 30px;
            display: flex; justify-content: center; align-items: flex-end;
            gap: 15px; padding-bottom: 10px;
            background-color: rgba(255, 255, 255, 0.05); /* å¾®å¾®åŠ äº®ç›®æ¨™å€ */
        }

        .btn-container { display: flex; gap: 20px; margin-bottom: 80px; }
        .btn {
            padding: 20px 50px; font-size: 2.2rem; font-weight: bold;
            border-radius: 60px; cursor: pointer; border: none; display: none;
        }
        .next-btn { background-color: var(--success-color); color: black; }
        .reset-btn { background-color: var(--error-color); color: white; }
    </style>
</head>
<body>

<div id="page1" class="page active">
    <div class="img-container">
        <img src="one.jpg" alt="æ­¥é©Ÿä¸€" class="top-img">
    </div>
    <h1>ç¬¬ä¸€é—œ</h1>
    <div class="pool" id="pool1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div class="word" draggable="true" id="w1-2" data-order="2" ondragstart="drag(event)" onclick="speak('æ”¾é€²')">æ”¾é€²</div>
        <div class="word" draggable="true" id="w1-1" data-order="1" ondragstart="drag(event)" onclick="speak('æŠŠé›è›‹')">æŠŠé›è›‹</div>
        <div class="word" draggable="true" id="w1-3" data-order="3" ondragstart="drag(event)" onclick="speak('å‡æ°´')">å‡æ°´</div>
    </div>
    <div class="feedback-area" id="fb1"></div>
    <div class="drop-zone" id="zone1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    <div class="btn-container">
        <button class="btn reset-btn" id="reset1" onclick="resetPage(1)">âŒ é‡æ–°è©¦è©¦</button>
        <button class="btn next-btn" id="next1" onclick="nextPage(2)">âœ”ï¸ ä¸‹ä¸€é¡Œ</button>
    </div>
</div>

<div id="page2" class="page">
    <div class="img-container">
        <img src="two.jpg" alt="æ­¥é©ŸäºŒ" class="top-img">
    </div>
    <h1>ç¬¬äºŒé—œ</h1>
    <div class="pool" id="pool2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div class="word" draggable="true" id="w2-3" data-order="3" ondragstart="drag(event)" onclick="speak('è›‹æ®¼')">è›‹æ®¼</div>
        <div class="word" draggable="true" id="w2-1" data-order="1" ondragstart="drag(event)" onclick="speak('è¼•è¼•')">è¼•è¼•</div>
        <div class="word" draggable="true" id="w2-2" data-order="2" ondragstart="drag(event)" onclick="speak('æ•²è£‚')">æ•²è£‚</div>
    </div>
    <div class="feedback-area" id="fb2"></div>
    <div class="drop-zone" id="zone2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    <div class="btn-container">
        <button class="btn reset-btn" id="reset2" onclick="resetPage(2)">âŒ é‡æ–°è©¦è©¦</button>
        <button class="btn next-btn" id="next2" onclick="nextPage(3)">âœ”ï¸ ä¸‹ä¸€é¡Œ</button>
    </div>
</div>

<div id="page3" class="page">
    <div class="img-container">
        <img src="three.jpg" alt="æ­¥é©Ÿä¸‰" class="top-img">
    </div>
    <h1>ç¬¬ä¸‰é—œ</h1>
    <div class="pool" id="pool3" ondrop="drop(event)" ondragover="allowDrop(event)">
        <div class="word" draggable="true" id="w3-2" data-order="2" ondragstart="drag(event)" onclick="speak('èŒ¶è‘‰è›‹')">èŒ¶è‘‰è›‹</div>
        <div class="word" draggable="true" id="w3-3" data-order="3" ondragstart="drag(event)" onclick="speak('ç…®å¥½äº†')">ç…®å¥½äº†</div>
        <div class="word" draggable="true" id="w3-1" data-order="1" ondragstart="drag(event)" onclick="speak('é¦™å™´å™´çš„')">é¦™å™´å™´çš„</div>
    </div>
    <div class="feedback-area" id="fb3"></div>
    <div class="drop-zone" id="zone3" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    <div class="btn-container">
        <button class="btn reset-btn" id="reset3" onclick="resetPage(3)">âŒ é‡æ–°è©¦è©¦</button>
        <button class="btn next-btn" id="next3" onclick="finishGame()">ğŸ‰ å®Œæˆç·´ç¿’</button>
    </div>
</div>

<script>
    // --- iPad è§¸æ§æ”¯æ´è¨­å®š (Magic Code) ---
    // é€™æ®µä»£ç¢¼æœƒè‡ªå‹•è®“ iPad æ”¯æ´æ‹–æ”¾
    var polyfillOptions = {
        dragImageCenterOnTouch: true, // æ‰‹æŒ‡æŒ‰ä½æ™‚ï¼Œè©èªæœƒç½®ä¸­
        iterationInterval: 20, // æå‡æ‹–æ‹‰æµæš¢åº¦
    };
    MobileDragDrop.polyfill(polyfillOptions);

    // è§£æ±ºæ‹–æ‹‰æ™‚æ»‘å‹•é é¢çš„å•é¡Œ
    window.addEventListener( 'touchmove', function() {}, {passive: false});
    // ------------------------------------

    function speak(text) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'zh-HK';
        utterance.rate = 0.8;
        window.speechSynthesis.speak(utterance);
    }

    function allowDrop(ev) { ev.preventDefault(); }
    function drag(ev) { 
        ev.dataTransfer.setData("text", ev.target.id);
        ev.dataTransfer.effectAllowed = "move";
    }

    function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        var draggedElement = document.getElementById(data);
        
        // ç¢ºä¿æ”¾åˆ°ç›®æ¨™å®¹å™¨å…§
        if(ev.currentTarget.classList.contains('drop-zone') || ev.currentTarget.classList.contains('pool')) {
            ev.currentTarget.appendChild(draggedElement);
            
            // å¦‚æœæ”¾åˆ°æ©«ç·šä¸Šï¼Œè®€å‡ºè²éŸ³
            if (ev.currentTarget.classList.contains('drop-zone')) {
                speak(draggedElement.innerText);
            }
            checkResult(ev.currentTarget.closest('.page'));
        }
    }

    function checkResult(pageElement) {
        const zone = pageElement.querySelector('.drop-zone');
        const items = [...zone.querySelectorAll('.word')];
        const fb = pageElement.querySelector('.feedback-area');
        const nextBtn = pageElement.querySelector('.next-btn');
        const resetBtn = pageElement.querySelector('.reset-btn');

        if (items.length === 3) {
            const currentOrder = items.map(i => i.getAttribute('data-order')).join('');
            if (currentOrder === "123") {
                fb.innerHTML = "âœ”ï¸ ç­”å°äº†ï¼";
                fb.style.color = "#00ff00";
                speak("ç­”å°äº†ï¼ä½ å¥½æ£’ï¼");
                nextBtn.style.display = 'block';
                resetBtn.style.display = 'none';
            } else {
                fb.innerHTML = "âŒ é †åºä¸å°";
                fb.style.color = "#ff3333";
                speak("é †åºå””ä¿‚å¹¾å•±å–ï¼Œå†è©¦ä¸‹å•¦ã€‚");
                resetBtn.style.display = 'block';
                nextBtn.style.display = 'none';
            }
        } else {
            fb.innerHTML = "";
            nextBtn.style.display = 'none';
            resetBtn.style.display = 'none';
        }
    }

    function resetPage(num) {
        const pool = document.getElementById('pool' + num);
        const zone = document.getElementById('zone' + num);
        const fb = document.getElementById('fb' + num);
        const items = [...zone.querySelectorAll('.word')];
        items.forEach(item => pool.appendChild(item));
        fb.innerHTML = "";
        document.getElementById('reset' + num).style.display = 'none';
        speak("è«‹é‡æ–°æ’åˆ—ã€‚");
    }

    function nextPage(num) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('page' + num).classList.add('active');
        speak("é€²å…¥ä¸‹ä¸€é¡Œ");
    }
    
    function finishGame() {
        speak("æ­å–œä½ ï¼Œå®Œæˆæ‰€æœ‰ç·´ç¿’ï¼");
        alert("ğŸ‰ å®Œæˆæ‰€æœ‰ç·´ç¿’ï¼");
    }
</script>

</body>
</html>
